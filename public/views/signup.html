<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Signup</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">

<h2>Signup</h2>

<form id="signupForm">
    <input class="form-control mb-2" placeholder="Username" id="username" required>
    <input class="form-control mb-2" placeholder="First Name" id="firstname" required>
    <input class="form-control mb-2" placeholder="Last Name" id="lastname" required>
    <input class="form-control mb-2" type="password" placeholder="Password" id="password" required>
    <button class="btn btn-primary">Signup</button>
</form>

<script>
document.getElementById("signupForm").addEventListener("submit", async (e) => {
    e.preventDefault(); // Prevent form from reloading the page

    // Get input values
    const username = document.getElementById("username").value.trim();
    const firstname = document.getElementById("firstname").value.trim();
    const lastname = document.getElementById("lastname").value.trim();
    const password = document.getElementById("password").value;

    // Create user object
    const user = { username, firstname, lastname, password };

    try {
        // Send POST request to backend
        const res = await fetch("/api/signup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(user)
        });

        const data = await res.json();

        if (res.ok) {
            alert(data.message); // Signup successful
            window.location.href = "/views/login.html"; // Redirect to login
        } else {
            alert(data.error); // Show backend error (e.g., username exists)
        }

    } catch (err) {
        console.error("Signup failed:", err);
        alert("An error occurred. Please try again.");
    }
});
</script>

</body>
</html>